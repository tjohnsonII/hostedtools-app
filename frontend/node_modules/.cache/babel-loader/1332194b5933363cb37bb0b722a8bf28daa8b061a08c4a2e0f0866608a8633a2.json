{"ast":null,"code":"import React,{useState}from'react';import'../css/navigationbar.css';// You need to install xlsx: npm install xlsx\nimport*as XLSX from'xlsx';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const defaultColumns=['Extension','Name','Email','Phone','Department'];const FPBXImport=()=>{const[columns,setColumns]=useState(defaultColumns);const[rows,setRows]=useState([{Extension:'',Name:'',Email:'',Phone:'',Department:''}]);// Handle file upload and parse\nconst handleFileUpload=e=>{var _e$target$files;const file=(_e$target$files=e.target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0];if(!file)return;const reader=new FileReader();reader.onload=evt=>{var _evt$target;const data=new Uint8Array((_evt$target=evt.target)===null||_evt$target===void 0?void 0:_evt$target.result);const workbook=XLSX.read(data,{type:'array'});const sheetName=workbook.SheetNames[0];const worksheet=workbook.Sheets[sheetName];const json=XLSX.utils.sheet_to_json(worksheet,{defval:''});if(json.length>0){setColumns(Object.keys(json[0]));setRows(json);}};reader.readAsArrayBuffer(file);};// Handle cell edit\nconst handleCellChange=(rowIdx,col,value)=>{const updatedRows=rows.map((row,idx)=>idx===rowIdx?{...row,[col]:value}:row);setRows(updatedRows);};// Add/remove row\nconst addRow=()=>setRows([...rows,Object.fromEntries(columns.map(c=>[c,'']))]);const removeRow=idx=>setRows(rows.filter((_,i)=>i!==idx));return/*#__PURE__*/_jsxs(\"div\",{className:\"fpbx-import\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"FPBX Import\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fpbx-file-upload\",children:\"Upload .xlsm/.xlsx file:\"}),/*#__PURE__*/_jsx(\"input\",{id:\"fpbx-file-upload\",type:\"file\",accept:\".xls,.xlsx,.xlsm\",onChange:handleFileUpload,title:\"Upload FPBX import spreadsheet\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"fpbx-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[columns.map(col=>/*#__PURE__*/_jsx(\"th\",{children:col},col)),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:rows.map((row,rowIdx)=>/*#__PURE__*/_jsxs(\"tr\",{children:[columns.map(col=>/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:row[col]||'',onChange:e=>handleCellChange(rowIdx,col,e.target.value),placeholder:col,title:col})},col)),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeRow(rowIdx),disabled:rows.length===1,children:\"-\"})})]},rowIdx))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:addRow,children:\"Add Row\"})]});};export default FPBXImport;","map":{"version":3,"names":["React","useState","XLSX","jsx","_jsx","jsxs","_jsxs","defaultColumns","FPBXImport","columns","setColumns","rows","setRows","Extension","Name","Email","Phone","Department","handleFileUpload","e","_e$target$files","file","target","files","reader","FileReader","onload","evt","_evt$target","data","Uint8Array","result","workbook","read","type","sheetName","SheetNames","worksheet","Sheets","json","utils","sheet_to_json","defval","length","Object","keys","readAsArrayBuffer","handleCellChange","rowIdx","col","value","updatedRows","map","row","idx","addRow","fromEntries","c","removeRow","filter","_","i","className","children","htmlFor","id","accept","onChange","title","placeholder","onClick","disabled"],"sources":["/home/tim2/hostedtools-app/frontend/src/pages/FPBXImport.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport '../css/navigationbar.css';\n// You need to install xlsx: npm install xlsx\nimport * as XLSX from 'xlsx';\n\nconst defaultColumns = ['Extension', 'Name', 'Email', 'Phone', 'Department'];\n\nconst FPBXImport: React.FC = () => {\n  const [columns, setColumns] = useState<string[]>(defaultColumns);\n  const [rows, setRows] = useState<Array<Record<string, string>>>([\n    { Extension: '', Name: '', Email: '', Phone: '', Department: '' },\n  ]);\n\n  // Handle file upload and parse\n  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = (evt) => {\n      const data = new Uint8Array(evt.target?.result as ArrayBuffer);\n      const workbook = XLSX.read(data, { type: 'array' });\n      const sheetName = workbook.SheetNames[0];\n      const worksheet = workbook.Sheets[sheetName];\n      const json = XLSX.utils.sheet_to_json<Record<string, string>>(worksheet, { defval: '' });\n      if (json.length > 0) {\n        setColumns(Object.keys(json[0]));\n        setRows(json);\n      }\n    };\n    reader.readAsArrayBuffer(file);\n  };\n\n  // Handle cell edit\n  const handleCellChange = (rowIdx: number, col: string, value: string) => {\n    const updatedRows = rows.map((row, idx) =>\n      idx === rowIdx ? { ...row, [col]: value } : row\n    );\n    setRows(updatedRows);\n  };\n\n  // Add/remove row\n  const addRow = () => setRows([...rows, Object.fromEntries(columns.map(c => [c, '']))]);\n  const removeRow = (idx: number) => setRows(rows.filter((_, i) => i !== idx));\n\n  return (\n    <div className=\"fpbx-import\">\n      <h2>FPBX Import</h2>\n      <label htmlFor=\"fpbx-file-upload\">Upload .xlsm/.xlsx file:</label>\n      <input\n        id=\"fpbx-file-upload\"\n        type=\"file\"\n        accept=\".xls,.xlsx,.xlsm\"\n        onChange={handleFileUpload}\n        title=\"Upload FPBX import spreadsheet\"\n      />\n      <table className=\"fpbx-table\">\n        <thead>\n          <tr>\n            {columns.map(col => <th key={col}>{col}</th>)}\n            <th>Action</th>\n          </tr>\n        </thead>\n        <tbody>\n          {rows.map((row, rowIdx) => (\n            <tr key={rowIdx}>\n              {columns.map(col => (\n                <td key={col}>\n                  <input\n                    type=\"text\"\n                    value={row[col] || ''}\n                    onChange={e => handleCellChange(rowIdx, col, e.target.value)}\n                    placeholder={col}\n                    title={col}\n                  />\n                </td>\n              ))}\n              <td>\n                <button onClick={() => removeRow(rowIdx)} disabled={rows.length === 1}>-</button>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n      <button onClick={addRow}>Add Row</button>\n    </div>\n  );\n};\n\nexport default FPBXImport;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}